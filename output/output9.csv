Executing query with shuffle_hash join strategy
== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- ShuffledHashJoin [AREA#4], [PREC#129], Inner, BuildRight
   :- Exchange hashpartitioning(AREA#4, 200), ENSURE_REQUIREMENTS, [plan_id=53]
   :  +- Project [DR_NO#0, Date Rptd#164, DATE OCC#193, TIME OCC#3, AREA#4, AREA NAME#5, Rpt Dist No#6, Part 1-2#7, Crm Cd#8, Crm Cd Desc#9, Mocodes#10, Vict Age#11, Vict Sex#12, Vict Descent#13, Premis Cd#14, Premis Desc#15, Weapon Used Cd#16, Weapon Desc#17, Status#18, Status Desc#19, Crm Cd 1#20, Crm Cd 2#21, Crm Cd 3#22, Crm Cd 4#23, ... 5 more fields]
   :     +- HashAggregate(keys=[Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 4 more fields], functions=[])
   :        +- Exchange hashpartitioning(Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 5 more fields), ENSURE_REQUIREMENTS, [plan_id=48]
   :           +- HashAggregate(keys=[Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, knownfloatingpointnormalized(normalizenanandzero(LON#27)) AS LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 4 more fields], functions=[])
   :              +- Union
   :                 :- Filter ((((isnotnull(AREA NAME#5) AND isnotnull(Weapon Used Cd#16)) AND NOT (AREA NAME#5 = Null Island)) AND (substring(cast(Weapon Used Cd#16 as string), 1, 1) = 1)) AND isnotnull(AREA#4))
   :                 :  +- FileScan csv [DR_NO#0,Date Rptd#1,DATE OCC#2,TIME OCC#3,AREA#4,AREA NAME#5,Rpt Dist No#6,Part 1-2#7,Crm Cd#8,Crm Cd Desc#9,Mocodes#10,Vict Age#11,Vict Sex#12,Vict Descent#13,Premis Cd#14,Premis Desc#15,Weapon Used Cd#16,Weapon Desc#17,Status#18,Status Desc#19,Crm Cd 1#20,Crm Cd 2#21,Crm Cd 3#22,Crm Cd 4#23,... 4 more fields] Batched: false, DataFilters: [isnotnull(AREA NAME#5), isnotnull(Weapon Used Cd#16), NOT (AREA NAME#5 = Null Island), (substrin..., Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/crime_data..., PartitionFilters: [], PushedFilters: [IsNotNull(AREA NAME), IsNotNull(Weapon Used Cd), Not(EqualTo(AREA NAME,Null Island)), IsNotNull(..., ReadSchema: struct<DR_NO:string,Date Rptd:string,DATE OCC:string,TIME OCC:int,AREA:int,AREA NAME:string,Rpt D...
   :                 +- Filter ((((isnotnull(AREA NAME#61) AND isnotnull(Weapon Used Cd#72)) AND NOT (AREA NAME#61 = Null Island)) AND (substring(cast(Weapon Used Cd#72 as string), 1, 1) = 1)) AND isnotnull(AREA#60))
   :                    +- FileScan csv [DR_NO#56,Date Rptd#57,DATE OCC#58,TIME OCC#59,AREA#60,AREA NAME#61,Rpt Dist No#62,Part 1-2#63,Crm Cd#64,Crm Cd Desc#65,Mocodes#66,Vict Age#67,Vict Sex#68,Vict Descent#69,Premis Cd#70,Premis Desc#71,Weapon Used Cd#72,Weapon Desc#73,Status#74,Status Desc#75,Crm Cd 1#76,Crm Cd 2#77,Crm Cd 3#78,Crm Cd 4#79,... 4 more fields] Batched: false, DataFilters: [isnotnull(AREA NAME#61), isnotnull(Weapon Used Cd#72), NOT (AREA NAME#61 = Null Island), (substr..., Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/crime_data..., PartitionFilters: [], PushedFilters: [IsNotNull(AREA NAME), IsNotNull(Weapon Used Cd), Not(EqualTo(AREA NAME,Null Island)), IsNotNull(..., ReadSchema: struct<DR_NO:string,Date Rptd:string,DATE OCC:string,TIME OCC:int,AREA:int,AREA NAME:string,Rpt D...
   +- Exchange hashpartitioning(PREC#129, 200), ENSURE_REQUIREMENTS, [plan_id=54]
      +- Filter isnotnull(PREC#129)
         +- FileScan csv [X#124,Y#125,FID#126,DIVISION#127,LOCATION#128,PREC#129] Batched: false, DataFilters: [isnotnull(PREC#129)], Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/LAPD_Polic..., PartitionFilters: [], PushedFilters: [IsNotNull(PREC)], ReadSchema: struct<X:double,Y:double,FID:int,DIVISION:string,LOCATION:string,PREC:int>


== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- ShuffledHashJoin [AREA#4], [PREC#129], Inner, BuildRight
   :- Exchange hashpartitioning(AREA#4, 200), ENSURE_REQUIREMENTS, [plan_id=109]
   :  +- Project [DR_NO#0, Date Rptd#164, DATE OCC#193, TIME OCC#3, AREA#4, AREA NAME#5, Rpt Dist No#6, Part 1-2#7, Crm Cd#8, Crm Cd Desc#9, Mocodes#10, Vict Age#11, Vict Sex#12, Vict Descent#13, Premis Cd#14, Premis Desc#15, Weapon Used Cd#16, Weapon Desc#17, Status#18, Status Desc#19, Crm Cd 1#20, Crm Cd 2#21, Crm Cd 3#22, Crm Cd 4#23, ... 5 more fields]
   :     +- HashAggregate(keys=[Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 4 more fields], functions=[])
   :        +- Exchange hashpartitioning(Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 5 more fields), ENSURE_REQUIREMENTS, [plan_id=104]
   :           +- HashAggregate(keys=[Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, knownfloatingpointnormalized(normalizenanandzero(LON#27)) AS LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 4 more fields], functions=[])
   :              +- Union
   :                 :- Filter (((isnotnull(AREA NAME#5) AND NOT (AREA NAME#5 = Null Island)) AND isnotnull(Weapon Used Cd#16)) AND isnotnull(AREA#4))
   :                 :  +- FileScan csv [DR_NO#0,Date Rptd#1,DATE OCC#2,TIME OCC#3,AREA#4,AREA NAME#5,Rpt Dist No#6,Part 1-2#7,Crm Cd#8,Crm Cd Desc#9,Mocodes#10,Vict Age#11,Vict Sex#12,Vict Descent#13,Premis Cd#14,Premis Desc#15,Weapon Used Cd#16,Weapon Desc#17,Status#18,Status Desc#19,Crm Cd 1#20,Crm Cd 2#21,Crm Cd 3#22,Crm Cd 4#23,... 4 more fields] Batched: false, DataFilters: [isnotnull(AREA NAME#5), NOT (AREA NAME#5 = Null Island), isnotnull(Weapon Used Cd#16), isnotnull..., Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/crime_data..., PartitionFilters: [], PushedFilters: [IsNotNull(AREA NAME), Not(EqualTo(AREA NAME,Null Island)), IsNotNull(Weapon Used Cd), IsNotNull(..., ReadSchema: struct<DR_NO:string,Date Rptd:string,DATE OCC:string,TIME OCC:int,AREA:int,AREA NAME:string,Rpt D...
   :                 +- Filter (((isnotnull(AREA NAME#61) AND NOT (AREA NAME#61 = Null Island)) AND isnotnull(Weapon Used Cd#72)) AND isnotnull(AREA#60))
   :                    +- FileScan csv [DR_NO#56,Date Rptd#57,DATE OCC#58,TIME OCC#59,AREA#60,AREA NAME#61,Rpt Dist No#62,Part 1-2#63,Crm Cd#64,Crm Cd Desc#65,Mocodes#66,Vict Age#67,Vict Sex#68,Vict Descent#69,Premis Cd#70,Premis Desc#71,Weapon Used Cd#72,Weapon Desc#73,Status#74,Status Desc#75,Crm Cd 1#76,Crm Cd 2#77,Crm Cd 3#78,Crm Cd 4#79,... 4 more fields] Batched: false, DataFilters: [isnotnull(AREA NAME#61), NOT (AREA NAME#61 = Null Island), isnotnull(Weapon Used Cd#72), isnotnu..., Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/crime_data..., PartitionFilters: [], PushedFilters: [IsNotNull(AREA NAME), Not(EqualTo(AREA NAME,Null Island)), IsNotNull(Weapon Used Cd), IsNotNull(..., ReadSchema: struct<DR_NO:string,Date Rptd:string,DATE OCC:string,TIME OCC:int,AREA:int,AREA NAME:string,Rpt D...
   +- Exchange hashpartitioning(PREC#129, 200), ENSURE_REQUIREMENTS, [plan_id=110]
      +- Filter isnotnull(PREC#129)
         +- FileScan csv [X#124,Y#125,FID#126,DIVISION#127,LOCATION#128,PREC#129] Batched: false, DataFilters: [isnotnull(PREC#129)], Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/LAPD_Polic..., PartitionFilters: [], PushedFilters: [IsNotNull(PREC)], ReadSchema: struct<X:double,Y:double,FID:int,DIVISION:string,LOCATION:string,PREC:int>


== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Sort [Year#222 ASC NULLS FIRST], true, 0
   +- Exchange rangepartitioning(Year#222 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [plan_id=199]
      +- HashAggregate(keys=[Year#222], functions=[count(1), avg(DISTANCE#465)])
         +- Exchange hashpartitioning(Year#222, 200), ENSURE_REQUIREMENTS, [plan_id=196]
            +- HashAggregate(keys=[Year#222], functions=[partial_count(1), partial_avg(DISTANCE#465)])
               +- Project [Year#222, cast(pythonUDF0#626 as double) AS DISTANCE#465]
                  +- BatchEvalPython [get_distance(LAT#26, LON#27, Y#125, X#124)#464], [pythonUDF0#626]
                     +- Project [LAT#26, LON#27, Year#222, X#124, Y#125]
                        +- ShuffledHashJoin [AREA#4], [PREC#129], Inner, BuildRight
                           :- Exchange hashpartitioning(AREA#4, 200), ENSURE_REQUIREMENTS, [plan_id=188]
                           :  +- HashAggregate(keys=[Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 4 more fields], functions=[])
                           :     +- Exchange hashpartitioning(Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 5 more fields), ENSURE_REQUIREMENTS, [plan_id=184]
                           :        +- HashAggregate(keys=[Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, knownfloatingpointnormalized(normalizenanandzero(LON#27)) AS LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 4 more fields], functions=[])
                           :           +- Union
                           :              :- Filter ((((isnotnull(AREA NAME#5) AND isnotnull(Weapon Used Cd#16)) AND NOT (AREA NAME#5 = Null Island)) AND (substring(cast(Weapon Used Cd#16 as string), 1, 1) = 1)) AND isnotnull(AREA#4))
                           :              :  +- FileScan csv [DR_NO#0,Date Rptd#1,DATE OCC#2,TIME OCC#3,AREA#4,AREA NAME#5,Rpt Dist No#6,Part 1-2#7,Crm Cd#8,Crm Cd Desc#9,Mocodes#10,Vict Age#11,Vict Sex#12,Vict Descent#13,Premis Cd#14,Premis Desc#15,Weapon Used Cd#16,Weapon Desc#17,Status#18,Status Desc#19,Crm Cd 1#20,Crm Cd 2#21,Crm Cd 3#22,Crm Cd 4#23,... 4 more fields] Batched: false, DataFilters: [isnotnull(AREA NAME#5), isnotnull(Weapon Used Cd#16), NOT (AREA NAME#5 = Null Island), (substrin..., Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/crime_data..., PartitionFilters: [], PushedFilters: [IsNotNull(AREA NAME), IsNotNull(Weapon Used Cd), Not(EqualTo(AREA NAME,Null Island)), IsNotNull(..., ReadSchema: struct<DR_NO:string,Date Rptd:string,DATE OCC:string,TIME OCC:int,AREA:int,AREA NAME:string,Rpt D...
                           :              +- Filter ((((isnotnull(AREA NAME#61) AND isnotnull(Weapon Used Cd#72)) AND NOT (AREA NAME#61 = Null Island)) AND (substring(cast(Weapon Used Cd#72 as string), 1, 1) = 1)) AND isnotnull(AREA#60))
                           :                 +- FileScan csv [DR_NO#56,Date Rptd#57,DATE OCC#58,TIME OCC#59,AREA#60,AREA NAME#61,Rpt Dist No#62,Part 1-2#63,Crm Cd#64,Crm Cd Desc#65,Mocodes#66,Vict Age#67,Vict Sex#68,Vict Descent#69,Premis Cd#70,Premis Desc#71,Weapon Used Cd#72,Weapon Desc#73,Status#74,Status Desc#75,Crm Cd 1#76,Crm Cd 2#77,Crm Cd 3#78,Crm Cd 4#79,... 4 more fields] Batched: false, DataFilters: [isnotnull(AREA NAME#61), isnotnull(Weapon Used Cd#72), NOT (AREA NAME#61 = Null Island), (substr..., Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/crime_data..., PartitionFilters: [], PushedFilters: [IsNotNull(AREA NAME), IsNotNull(Weapon Used Cd), Not(EqualTo(AREA NAME,Null Island)), IsNotNull(..., ReadSchema: struct<DR_NO:string,Date Rptd:string,DATE OCC:string,TIME OCC:int,AREA:int,AREA NAME:string,Rpt D...
                           +- Exchange hashpartitioning(PREC#129, 200), ENSURE_REQUIREMENTS, [plan_id=189]
                              +- Filter isnotnull(PREC#129)
                                 +- FileScan csv [X#124,Y#125,PREC#129] Batched: false, DataFilters: [isnotnull(PREC#129)], Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/LAPD_Polic..., PartitionFilters: [], PushedFilters: [IsNotNull(PREC)], ReadSchema: struct<X:double,Y:double,PREC:int>


== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Sort [num_crimes#620L DESC NULLS LAST], true, 0
   +- Exchange rangepartitioning(num_crimes#620L DESC NULLS LAST, 200), ENSURE_REQUIREMENTS, [plan_id=288]
      +- HashAggregate(keys=[DIVISION#127], functions=[count(1), avg(DISTANCE#503)])
         +- Exchange hashpartitioning(DIVISION#127, 200), ENSURE_REQUIREMENTS, [plan_id=285]
            +- HashAggregate(keys=[DIVISION#127], functions=[partial_count(1), partial_avg(DISTANCE#503)])
               +- Project [DIVISION#127, cast(pythonUDF0#633 as double) AS DISTANCE#503]
                  +- BatchEvalPython [get_distance(LAT#26, LON#27, Y#125, X#124)#502], [pythonUDF0#633]
                     +- Project [LAT#26, LON#27, X#124, Y#125, DIVISION#127]
                        +- ShuffledHashJoin [AREA#4], [PREC#129], Inner, BuildRight
                           :- Exchange hashpartitioning(AREA#4, 200), ENSURE_REQUIREMENTS, [plan_id=277]
                           :  +- HashAggregate(keys=[Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 4 more fields], functions=[])
                           :     +- Exchange hashpartitioning(Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 5 more fields), ENSURE_REQUIREMENTS, [plan_id=273]
                           :        +- HashAggregate(keys=[Premis Cd#14, TIME OCC#3, Crm Cd 1#20, Part 1-2#7, AREA#4, DR_NO#0, DATE OCC#2, Crm Cd 4#23, Weapon Desc#17, Vict Descent#13, Status Desc#19, Premis Desc#15, Vict Age#11, Rpt Dist No#6, Date Rptd#1, Mocodes#10, LOCATION#24, Crm Cd 3#22, Vict Sex#12, Cross Street#25, knownfloatingpointnormalized(normalizenanandzero(LON#27)) AS LON#27, Crm Cd#8, AREA NAME#5, Crm Cd Desc#9, ... 4 more fields], functions=[])
                           :           +- Union
                           :              :- Filter (((isnotnull(AREA NAME#5) AND NOT (AREA NAME#5 = Null Island)) AND isnotnull(Weapon Used Cd#16)) AND isnotnull(AREA#4))
                           :              :  +- FileScan csv [DR_NO#0,Date Rptd#1,DATE OCC#2,TIME OCC#3,AREA#4,AREA NAME#5,Rpt Dist No#6,Part 1-2#7,Crm Cd#8,Crm Cd Desc#9,Mocodes#10,Vict Age#11,Vict Sex#12,Vict Descent#13,Premis Cd#14,Premis Desc#15,Weapon Used Cd#16,Weapon Desc#17,Status#18,Status Desc#19,Crm Cd 1#20,Crm Cd 2#21,Crm Cd 3#22,Crm Cd 4#23,... 4 more fields] Batched: false, DataFilters: [isnotnull(AREA NAME#5), NOT (AREA NAME#5 = Null Island), isnotnull(Weapon Used Cd#16), isnotnull..., Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/crime_data..., PartitionFilters: [], PushedFilters: [IsNotNull(AREA NAME), Not(EqualTo(AREA NAME,Null Island)), IsNotNull(Weapon Used Cd), IsNotNull(..., ReadSchema: struct<DR_NO:string,Date Rptd:string,DATE OCC:string,TIME OCC:int,AREA:int,AREA NAME:string,Rpt D...
                           :              +- Filter (((isnotnull(AREA NAME#61) AND NOT (AREA NAME#61 = Null Island)) AND isnotnull(Weapon Used Cd#72)) AND isnotnull(AREA#60))
                           :                 +- FileScan csv [DR_NO#56,Date Rptd#57,DATE OCC#58,TIME OCC#59,AREA#60,AREA NAME#61,Rpt Dist No#62,Part 1-2#63,Crm Cd#64,Crm Cd Desc#65,Mocodes#66,Vict Age#67,Vict Sex#68,Vict Descent#69,Premis Cd#70,Premis Desc#71,Weapon Used Cd#72,Weapon Desc#73,Status#74,Status Desc#75,Crm Cd 1#76,Crm Cd 2#77,Crm Cd 3#78,Crm Cd 4#79,... 4 more fields] Batched: false, DataFilters: [isnotnull(AREA NAME#61), NOT (AREA NAME#61 = Null Island), isnotnull(Weapon Used Cd#72), isnotnu..., Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/crime_data..., PartitionFilters: [], PushedFilters: [IsNotNull(AREA NAME), Not(EqualTo(AREA NAME,Null Island)), IsNotNull(Weapon Used Cd), IsNotNull(..., ReadSchema: struct<DR_NO:string,Date Rptd:string,DATE OCC:string,TIME OCC:int,AREA:int,AREA NAME:string,Rpt D...
                           +- Exchange hashpartitioning(PREC#129, 200), ENSURE_REQUIREMENTS, [plan_id=278]
                              +- Filter isnotnull(PREC#129)
                                 +- FileScan csv [X#124,Y#125,DIVISION#127,PREC#129] Batched: false, DataFilters: [isnotnull(PREC#129)], Format: CSV, Location: InMemoryFileIndex(1 paths)[hdfs://okeanos-master:54310/user/ubuntu/ta/advanced-db/data/LAPD_Polic..., PartitionFilters: [], PushedFilters: [IsNotNull(PREC)], ReadSchema: struct<X:double,Y:double,DIVISION:string,PREC:int>


Απόσταση από το αστυνομικό τμήμα που ανέλαβε την έρευνα για το περιστατικό:
(a)
+----+----------+------------------+
|Year|num_crimes|  average_distance|
+----+----------+------------------+
|2010|      8213| 4.315547525861608|
|2011|      7232| 2.793178303182612|
|2012|      6550|37.401521647671046|
|2013|      5838|2.8264127212019594|
|2014|      4230|11.631025289489857|
|2015|      6763|2.7060979927623863|
|2016|      8100|2.7176445421299738|
|2017|      7788| 5.955847913803795|
|2018|      7413|2.7328236492298763|
|2019|      7129| 2.739941972172157|
|2020|      8491| 8.614767812336174|
|2021|      9767|30.978341295560913|
|2022|     10025| 2.608656186450799|
|2023|      8741| 2.555141057454318|
+----+----------+------------------+

(b)
+---------------+----------+------------------+
|       DIVISION|num_crimes|  average_distance|
+---------------+----------+------------------+
|    77TH STREET|     94474| 13.16207905288864|
|      SOUTHEAST|     72832|14.527525557921942|
|      SOUTHWEST|     72461| 9.898850561768901|
|        CENTRAL|     63264|23.466578376497438|
|         NEWTON|     61160|13.979683650325219|
|        RAMPART|     55611|19.847575514306257|
|      HOLLYWOOD|     50958|27.846180453247317|
|        OLYMPIC|     48886| 17.19463769893068|
|        PACIFIC|     42760| 25.07216183921986|
|     HOLLENBECK|     41393|19.600667247278327|
|        MISSION|     40880| 21.33030578096523|
|         HARBOR|     40637|14.160243637196208|
|NORTH HOLLYWOOD|     39542|17.184089891996916|
|       WILSHIRE|     37712|16.080369127183218|
|      NORTHEAST|     37101|12.799215742840685|
|       VAN NUYS|     36080| 19.92610084395558|
|    WEST VALLEY|     33694| 15.34466222860927|
|        TOPANGA|     32340|7.0193887683128064|
|       FOOTHILL|     32337|16.293601573548358|
|     DEVONSHIRE|     28673|16.711290454913446|
+---------------+----------+------------------+
only showing top 20 rows

Απόσταση από το πλησιέστερο αστυνομικό τμήμα:
(a)
+----+----------+------------------+
|Year|num_crimes|  average_distance|
+----+----------+------------------+
|2010|      8213| 3.965480506097993|
|2011|      7232|  2.46181888566459|
|2012|      6550| 37.04806556244542|
|2013|      5838| 2.456180337945909|
|2014|      4230|11.240705060052028|
|2015|      6763|  2.38790278176303|
|2016|      8100|2.4291509215379303|
|2017|      7788| 5.620278866952371|
|2018|      7413| 2.409083506096955|
|2019|      7129|2.4301661049761214|
|2020|      8491| 8.305664894299344|
|2021|      9767|30.666116941658927|
|2022|     10025|2.3129679282459743|
|2023|      8741|2.2716948056968675|
+----+----------+------------------+

(b)
+----------------+----------+------------------+
|        DIVISION|num_crimes|  average_distance|
+----------------+----------+------------------+
|     77TH STREET|     78830|1.6735955739672674|
|       SOUTHWEST|     78068| 2.161146839862122|
|       HOLLYWOOD|     70652|1.9193991303646156|
|       SOUTHEAST|     66697|2.2222328122967405|
|         OLYMPIC|     60553|1.6657781632089455|
|         CENTRAL|     59420| 0.866802366302343|
|        WILSHIRE|     58032|2.4783030061160023|
|         RAMPART|     56297| 1.361662592838379|
|        VAN NUYS|     55252|2.8073800912108107|
|          NEWTON|     45398| 1.599899828604748|
|      HOLLENBECK|     43128| 326.0868010778892|
|         PACIFIC|     40356| 3.845258334030655|
| NORTH HOLLYWOOD|     40174| 2.592639241249372|
|          HARBOR|     39433|  3.68675136587339|
|        FOOTHILL|     38327| 3.977261444227064|
|     WEST VALLEY|     34804|2.8501254142896926|
|         TOPANGA|     32648| 3.045398368787074|
|       NORTHEAST|     27283| 3.765925137599393|
|         MISSION|     27016| 3.784037220911298|
|WEST LOS ANGELES|     22376| 2.712234758681144|
+----------------+----------+------------------+
only showing top 20 rows

